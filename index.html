<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FLUKE: Linguistically-Driven Robustness Evaluation</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Newsreader:ital,wght@0,400;0,500;0,600;1,400&family=IBM+Plex+Sans:wght@400;500;600&family=IBM+Plex+Mono:wght@400;500&display=swap" rel="stylesheet">
    <style>
        :root {
            --black: #111;
            --gray-900: #1a1a1a;
            --gray-700: #444;
            --gray-500: #777;
            --gray-300: #bbb;
            --gray-100: #f5f5f5;
            --white: #fff;
            --accent: #d63031;
            --blue: #2d5fd3;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'IBM Plex Sans', -apple-system, sans-serif;
            color: var(--gray-900);
            line-height: 1.6;
            font-size: 16px;
            background: var(--white);
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 40px;
        }

        /* Header */
        header {
            padding: 80px 0 60px;
            border-bottom: 1px solid var(--gray-100);
        }

        .venue {
            font-family: 'IBM Plex Mono', monospace;
            font-size: 12px;
            font-weight: 500;
            letter-spacing: 0.05em;
            text-transform: uppercase;
            color: var(--accent);
            margin-bottom: 16px;
        }

        h1 {
            font-family: 'Newsreader', Georgia, serif;
            font-size: clamp(32px, 5vw, 48px);
            font-weight: 500;
            line-height: 1.2;
            margin-bottom: 20px;
            max-width: 800px;
        }

        .acronym {
            font-family: 'IBM Plex Mono', monospace;
            font-size: 14px;
            color: var(--gray-500);
            margin-bottom: 24px;
        }

        .acronym strong {
            color: var(--gray-900);
            text-decoration: underline;
            text-decoration-color: var(--accent);
            text-underline-offset: 2px;
        }

        .subtitle {
            font-size: 18px;
            color: var(--gray-700);
            max-width: 680px;
            margin-bottom: 32px;
            line-height: 1.7;
        }

        .links {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
        }

        .links a {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 10px 20px;
            font-size: 14px;
            font-weight: 500;
            text-decoration: none;
            border: 1px solid var(--gray-300);
            color: var(--gray-900);
            transition: all 0.2s;
        }

        .links a:hover {
            border-color: var(--gray-900);
            background: var(--gray-900);
            color: var(--white);
        }

        .links a svg {
            width: 16px;
            height: 16px;
        }

        /* Sections */
        section {
            padding: 60px 0;
            border-bottom: 1px solid var(--gray-100);
        }

        section:last-of-type {
            border-bottom: none;
        }

        .section-title {
            font-family: 'IBM Plex Mono', monospace;
            font-size: 11px;
            font-weight: 600;
            letter-spacing: 0.1em;
            text-transform: uppercase;
            color: var(--gray-500);
            margin-bottom: 20px;
        }

        h2 {
            font-family: 'Newsreader', Georgia, serif;
            font-size: 28px;
            font-weight: 500;
            margin-bottom: 16px;
        }

        p {
            color: var(--gray-700);
            margin-bottom: 16px;
            max-width: 680px;
        }

        /* Findings */
        .findings-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 24px;
            margin-top: 32px;
        }

        .finding {
            padding: 24px;
            background: var(--gray-100);
        }

        .finding-num {
            font-family: 'IBM Plex Mono', monospace;
            font-size: 12px;
            font-weight: 600;
            color: var(--accent);
            margin-bottom: 8px;
        }

        .finding h3 {
            font-family: 'Newsreader', Georgia, serif;
            font-size: 18px;
            font-weight: 500;
            margin-bottom: 8px;
        }

        .finding p {
            font-size: 14px;
            margin-bottom: 0;
        }

        /* Tables */
        .table-wrapper {
            overflow-x: auto;
            margin: 32px 0;
            border: 1px solid var(--gray-100);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 13px;
        }

        th {
            background: var(--gray-900);
            color: var(--white);
            padding: 12px 10px;
            text-align: left;
            font-weight: 600;
            font-size: 11px;
            letter-spacing: 0.02em;
            white-space: nowrap;
        }

        td {
            padding: 10px;
            border-bottom: 1px solid var(--gray-100);
            white-space: nowrap;
        }

        tr:hover td {
            background: var(--gray-100);
        }

        .cat-cell {
            font-weight: 600;
            color: var(--gray-900);
            font-family: 'IBM Plex Mono', monospace;
            font-size: 11px;
            letter-spacing: 0.02em;
        }

        .mod-cell {
            font-weight: 500;
        }

        .num-cell {
            text-align: center;
            font-family: 'IBM Plex Mono', monospace;
            font-size: 12px;
        }

        .high { background: #fee2e2; color: #991b1b; font-weight: 600; }
        .med { background: #fef3c7; color: #92400e; }
        .low { background: #d1fae5; color: #065f46; }

        .avg-row td {
            background: var(--gray-100);
            font-weight: 600;
        }

        .table-caption {
            font-size: 13px;
            color: var(--gray-500);
            margin-top: 12px;
            font-style: italic;
        }

        /* Tabs */
        .tabs {
            display: flex;
            gap: 4px;
            border-bottom: 1px solid var(--gray-100);
            margin-bottom: 24px;
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
        }

        .tab {
            padding: 12px 20px;
            font-size: 13px;
            font-weight: 500;
            color: var(--gray-500);
            background: none;
            border: none;
            cursor: pointer;
            white-space: nowrap;
            border-bottom: 2px solid transparent;
            margin-bottom: -1px;
            transition: all 0.2s;
        }

        .tab:hover {
            color: var(--gray-900);
        }

        .tab.active {
            color: var(--gray-900);
            border-bottom-color: var(--accent);
        }

        .tab-panel {
            display: none;
        }

        .tab-panel.active {
            display: block;
        }

        .task-badge {
            display: inline-block;
            font-family: 'IBM Plex Mono', monospace;
            font-size: 10px;
            font-weight: 600;
            letter-spacing: 0.05em;
            text-transform: uppercase;
            padding: 4px 10px;
            margin-left: 8px;
            vertical-align: middle;
        }

        .task-badge.cls { background: var(--blue); color: white; }
        .task-badge.gen { background: var(--accent); color: white; }

        /* Task grid */
        .task-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 16px;
            margin-top: 24px;
        }

        .task {
            padding: 20px;
            border: 1px solid var(--gray-100);
        }

        .task-type {
            font-family: 'IBM Plex Mono', monospace;
            font-size: 10px;
            font-weight: 600;
            letter-spacing: 0.05em;
            text-transform: uppercase;
            padding: 3px 8px;
            margin-bottom: 10px;
            display: inline-block;
        }

        .task-type.cls { background: var(--blue); color: white; }
        .task-type.gen { background: var(--accent); color: white; }

        .task h4 {
            font-family: 'Newsreader', Georgia, serif;
            font-size: 16px;
            font-weight: 500;
            margin-bottom: 4px;
        }

        .task p {
            font-size: 13px;
            color: var(--gray-500);
            margin: 0;
        }

        /* Models */
        .model-grid {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 20px;
        }

        .model {
            padding: 8px 16px;
            background: var(--gray-100);
            font-size: 13px;
            font-weight: 500;
        }

        .model.reasoning {
            background: var(--gray-900);
            color: var(--white);
        }

        /* Citation */
        .citation-box {
            background: var(--gray-900);
            color: var(--gray-300);
            padding: 24px;
            font-family: 'IBM Plex Mono', monospace;
            font-size: 12px;
            line-height: 1.8;
            overflow-x: auto;
            position: relative;
        }

        .citation-box pre {
            margin: 0;
        }

        .copy-btn {
            position: absolute;
            top: 12px;
            right: 12px;
            background: transparent;
            border: 1px solid var(--gray-500);
            color: var(--gray-300);
            padding: 6px 12px;
            font-size: 11px;
            font-family: 'IBM Plex Sans', sans-serif;
            cursor: pointer;
            transition: all 0.2s;
        }

        .copy-btn:hover {
            background: var(--white);
            color: var(--gray-900);
        }

        /* Footer */
        footer {
            padding: 40px 0;
            text-align: center;
            font-size: 13px;
            color: var(--gray-500);
        }

        footer a {
            color: var(--gray-700);
        }

        /* Demo Section */
        .demo-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 24px;
            margin-top: 24px;
        }

        .demo-input, .demo-output {
            display: flex;
            flex-direction: column;
        }

        .demo-label {
            font-family: 'IBM Plex Mono', monospace;
            font-size: 11px;
            font-weight: 600;
            letter-spacing: 0.05em;
            text-transform: uppercase;
            color: var(--gray-500);
            margin-bottom: 8px;
        }

        .demo-textarea {
            width: 100%;
            min-height: 120px;
            padding: 16px;
            font-family: 'IBM Plex Sans', sans-serif;
            font-size: 14px;
            line-height: 1.6;
            border: 1px solid var(--gray-300);
            background: var(--white);
            resize: vertical;
        }

        .demo-textarea:focus {
            outline: none;
            border-color: var(--gray-900);
        }

        .demo-textarea.output {
            background: var(--gray-100);
            color: var(--gray-900);
        }

        .demo-controls {
            display: flex;
            gap: 12px;
            margin-top: 16px;
            flex-wrap: wrap;
            align-items: center;
        }

        .demo-select {
            padding: 10px 16px;
            font-family: 'IBM Plex Sans', sans-serif;
            font-size: 14px;
            border: 1px solid var(--gray-300);
            background: var(--white);
            cursor: pointer;
            min-width: 180px;
        }

        .demo-select:focus {
            outline: none;
            border-color: var(--gray-900);
        }

        .demo-btn {
            padding: 10px 24px;
            font-family: 'IBM Plex Sans', sans-serif;
            font-size: 14px;
            font-weight: 500;
            background: var(--gray-900);
            color: var(--white);
            border: none;
            cursor: pointer;
            transition: all 0.2s;
        }

        .demo-btn:hover {
            background: var(--black);
        }

        .demo-btn:disabled {
            background: var(--gray-300);
            cursor: not-allowed;
        }

        .demo-api-key {
            padding: 10px 16px;
            font-family: 'IBM Plex Mono', monospace;
            font-size: 13px;
            border: 1px solid var(--gray-300);
            background: var(--white);
            width: 280px;
        }

        .demo-api-key::placeholder {
            color: var(--gray-500);
        }

        .demo-status {
            font-size: 13px;
            color: var(--gray-500);
            margin-top: 12px;
        }

        .demo-status.error {
            color: var(--accent);
        }

        .demo-status.success {
            color: #065f46;
        }

        .demo-meta {
            margin-top: 12px;
            padding: 12px;
            background: var(--gray-100);
            font-size: 12px;
            display: none;
        }

        .demo-meta.visible {
            display: block;
        }

        .demo-meta-item {
            margin-bottom: 4px;
        }

        .demo-meta-label {
            font-weight: 600;
            color: var(--gray-700);
        }

        .demo-note {
            font-size: 12px;
            color: var(--gray-500);
            margin-top: 16px;
            padding: 12px;
            background: var(--gray-100);
            border-left: 3px solid var(--gray-300);
        }

        /* Demo Tabs */
        .demo-tabs {
            display: flex;
            gap: 0;
            margin-bottom: 24px;
            border-bottom: 1px solid var(--gray-300);
        }

        .demo-tab {
            padding: 12px 24px;
            font-size: 14px;
            font-weight: 500;
            color: var(--gray-500);
            background: none;
            border: none;
            cursor: pointer;
            border-bottom: 2px solid transparent;
            margin-bottom: -1px;
            transition: all 0.2s;
        }

        .demo-tab:hover {
            color: var(--gray-900);
        }

        .demo-tab.active {
            color: var(--gray-900);
            border-bottom-color: var(--accent);
        }

        .demo-panel {
            display: none;
        }

        .demo-panel.active {
            display: block;
        }

        /* Batch Processing */
        .batch-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
            margin-bottom: 16px;
        }

        .batch-field {
            display: flex;
            flex-direction: column;
        }

        .batch-field label {
            font-size: 13px;
            font-weight: 500;
            color: var(--gray-700);
            margin-bottom: 6px;
        }

        .batch-field input, .batch-field select {
            padding: 10px 12px;
            font-size: 14px;
            border: 1px solid var(--gray-300);
            background: var(--white);
        }

        .batch-field input:focus, .batch-field select:focus {
            outline: none;
            border-color: var(--gray-900);
        }

        .file-upload {
            border: 2px dashed var(--gray-300);
            padding: 24px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s;
            margin-bottom: 20px;
        }

        .file-upload:hover {
            border-color: var(--gray-500);
        }

        .file-upload.has-file {
            border-color: var(--blue);
            background: #f0f7ff;
        }

        .file-upload input {
            display: none;
        }

        .file-upload-text {
            font-size: 14px;
            color: var(--gray-500);
        }

        .file-upload-text strong {
            color: var(--gray-900);
        }

        .mod-checkboxes {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 8px;
            margin-top: 8px;
        }

        .mod-checkbox {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 13px;
            cursor: pointer;
        }

        .mod-checkbox input {
            cursor: pointer;
        }

        .mod-category-label {
            font-family: 'IBM Plex Mono', monospace;
            font-size: 10px;
            font-weight: 600;
            color: var(--accent);
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-top: 12px;
            margin-bottom: 6px;
        }

        .mod-category-label:first-of-type {
            margin-top: 0;
        }

        .batch-actions {
            display: flex;
            gap: 12px;
            margin-top: 8px;
            margin-bottom: 20px;
        }

        .batch-actions button {
            padding: 6px 12px;
            font-size: 12px;
            background: var(--gray-100);
            border: 1px solid var(--gray-300);
            cursor: pointer;
        }

        .batch-actions button:hover {
            background: var(--gray-300);
        }

        .progress-container {
            margin-top: 20px;
            display: none;
        }

        .progress-container.visible {
            display: block;
        }

        .progress-bar {
            height: 8px;
            background: var(--gray-100);
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: var(--blue);
            width: 0%;
            transition: width 0.3s;
        }

        .progress-text {
            font-size: 13px;
            color: var(--gray-500);
            margin-top: 8px;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .findings-grid, .task-grid {
                grid-template-columns: 1fr;
            }

            .demo-container {
                grid-template-columns: 1fr;
            }

            .demo-controls {
                flex-direction: column;
                align-items: stretch;
            }

            .demo-select, .demo-api-key {
                width: 100%;
            }

            .batch-row {
                grid-template-columns: 1fr;
            }

            .mod-checkboxes {
                grid-template-columns: repeat(2, 1fr);
            }

            header { padding: 60px 0 40px; }
            section { padding: 40px 0; }
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <div class="venue">Preprint</div>
            <h1>FLUKE: A Linguistically-Driven and Task-Agnostic Framework for Robustness Evaluation</h1>
            <p class="authors" style="font-size: 15px; color: var(--gray-700); margin-bottom: 8px;">
                Yulia Otmakhova<sup>1*</sup>, Hung Thinh Truong<sup>1*</sup>, Rahmad Mahendra<sup>2</sup>, Zenan Zhai<sup>3</sup>, Rongxin Zhu<sup>1,3</sup>, Daniel Beck<sup>2</sup>, Jey Han Lau<sup>1</sup>
            </p>
            <p class="affiliations" style="font-size: 13px; color: var(--gray-500); margin-bottom: 24px;">
                <sup>1</sup>The University of Melbourne &nbsp; <sup>2</sup>RMIT University &nbsp; <sup>3</sup>Oracle
            </p>
            <p class="subtitle">
                FLUKE introduces controlled variations across linguistic levels—from orthography to dialect—to systematically evaluate model robustness through minimal modifications of test data.
            </p>
            <div class="links">
                <a href="https://arxiv.org/abs/2504.17311">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/></svg>
                    Paper
                </a>
                <a href="https://github.com/joey234/fluke">
                    <svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/></svg>
                    Code
                </a>
                <a href="https://huggingface.co/datasets/unimelb-nlp/fluke">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><ellipse cx="12" cy="5" rx="9" ry="3"/><path d="M21 12c0 1.66-4 3-9 3s-9-1.34-9-3"/><path d="M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5"/></svg>
                    Dataset
                </a>
                <a href="https://fluke-viewer.pages.dev/">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2"/><line x1="3" y1="9" x2="21" y2="9"/></svg>
                    Demo
                </a>
            </div>
        </div>
    </header>

    <section id="abstract">
        <div class="container">
            <div class="section-title">Abstract</div>
            <p>
                We present <strong>FLUKE</strong>, a task-agnostic framework for assessing model robustness through systematic minimal variations of test data. FLUKE introduces controlled variations across linguistic levels—from orthography to dialect and style—and leverages large language models with human validation to generate modifications.
            </p>
            <p>
                We evaluate both fine-tuned models and LLMs across six diverse NLP tasks, revealing that: (1) linguistic variations impact is highly task-dependent; (2) LLMs still exhibit significant brittleness, with reasoning LLMs showing less robustness on some tasks; (3) natural modifications hurt more than corruption-style tests; (4) generation ability doesn't correlate with robustness.
            </p>
        </div>
    </section>

    <section id="examples">
        <div class="container">
            <div class="section-title">Examples</div>
            <h2>Modification Types</h2>
            <p>FLUKE applies controlled linguistic modifications that preserve task labels while testing model robustness.</p>

            <div class="examples-grid" style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px; margin-top: 28px;">
                <!-- Orthography -->
                <div class="example-card" style="background: var(--gray-100); padding: 16px;">
                    <div style="font-family: 'IBM Plex Mono', monospace; font-size: 10px; font-weight: 600; color: var(--accent); margin-bottom: 6px; text-transform: uppercase; letter-spacing: 0.05em;">Capitalization</div>
                    <div style="font-size: 13px; margin-bottom: 6px; color: var(--gray-700);">The B-52 <u>pilot</u>, Major Messinger</div>
                    <div style="font-size: 13px; color: var(--gray-900);">The B-52 <u>PILOT</u>, Major Messinger</div>
                </div>

                <div class="example-card" style="background: var(--gray-100); padding: 16px;">
                    <div style="font-family: 'IBM Plex Mono', monospace; font-size: 10px; font-weight: 600; color: var(--accent); margin-bottom: 6px; text-transform: uppercase; letter-spacing: 0.05em;">Punctuation</div>
                    <div style="font-size: 13px; margin-bottom: 6px; color: var(--gray-700);"><u>Fort Wayne</u> Line trains</div>
                    <div style="font-size: 13px; color: var(--gray-900);"><u>FortWayne</u> Line trains</div>
                </div>

                <div class="example-card" style="background: var(--gray-100); padding: 16px;">
                    <div style="font-family: 'IBM Plex Mono', monospace; font-size: 10px; font-weight: 600; color: var(--accent); margin-bottom: 6px; text-transform: uppercase; letter-spacing: 0.05em;">Spelling (Typo)</div>
                    <div style="font-size: 13px; margin-bottom: 6px; color: var(--gray-700);">Grosvenor <u>Square</u> in the 1960s</div>
                    <div style="font-size: 13px; color: var(--gray-900);">Grosvenor <u>Squar</u> in the 1960s</div>
                </div>

                <!-- Morphology -->
                <div class="example-card" style="background: var(--gray-100); padding: 16px;">
                    <div style="font-family: 'IBM Plex Mono', monospace; font-size: 10px; font-weight: 600; color: var(--accent); margin-bottom: 6px; text-transform: uppercase; letter-spacing: 0.05em;">Derivation</div>
                    <div style="font-size: 13px; margin-bottom: 6px; color: var(--gray-700);">a software company <u>created</u> in 2009</div>
                    <div style="font-size: 13px; color: var(--gray-900);">a software company <u>born</u> in 2009</div>
                </div>

                <div class="example-card" style="background: var(--gray-100); padding: 16px;">
                    <div style="font-family: 'IBM Plex Mono', monospace; font-size: 10px; font-weight: 600; color: var(--accent); margin-bottom: 6px; text-transform: uppercase; letter-spacing: 0.05em;">Compound Words</div>
                    <div style="font-size: 13px; margin-bottom: 6px; color: var(--gray-700);">a <u>gated community</u> called Orchid Island</div>
                    <div style="font-size: 13px; color: var(--gray-900);">a <u>high-security gated community</u> called Orchid Island</div>
                </div>

                <!-- Syntax -->
                <div class="example-card" style="background: var(--gray-100); padding: 16px;">
                    <div style="font-family: 'IBM Plex Mono', monospace; font-size: 10px; font-weight: 600; color: var(--accent); margin-bottom: 6px; text-transform: uppercase; letter-spacing: 0.05em;">Active→Passive</div>
                    <div style="font-size: 13px; margin-bottom: 6px; color: var(--gray-700);">Back to Basics <u>focuses on</u> genre classics</div>
                    <div style="font-size: 13px; color: var(--gray-900);">Genre classics <u>are focused on</u> by Back to Basics</div>
                </div>

                <div class="example-card" style="background: var(--gray-100); padding: 16px;">
                    <div style="font-family: 'IBM Plex Mono', monospace; font-size: 10px; font-weight: 600; color: var(--accent); margin-bottom: 6px; text-transform: uppercase; letter-spacing: 0.05em;">Grammatical Role</div>
                    <div style="font-size: 13px; margin-bottom: 6px; color: var(--gray-700);">ran for <u>the House</u> from <u>New York</u></div>
                    <div style="font-size: 13px; color: var(--gray-900);">ran for <u>New York</u> from <u>the House</u></div>
                </div>

                <div class="example-card" style="background: var(--gray-100); padding: 16px;">
                    <div style="font-family: 'IBM Plex Mono', monospace; font-size: 10px; font-weight: 600; color: var(--accent); margin-bottom: 6px; text-transform: uppercase; letter-spacing: 0.05em;">Coord. Conjunction</div>
                    <div style="font-size: 13px; margin-bottom: 6px; color: var(--gray-700);">conflicts were <u>making</u> headlines</div>
                    <div style="font-size: 13px; color: var(--gray-900);">conflicts were <u>escalating and making</u> headlines</div>
                </div>

                <!-- Semantics -->
                <div class="example-card" style="background: var(--gray-100); padding: 16px;">
                    <div style="font-family: 'IBM Plex Mono', monospace; font-size: 10px; font-weight: 600; color: var(--accent); margin-bottom: 6px; text-transform: uppercase; letter-spacing: 0.05em;">Concept Replacement</div>
                    <div style="font-size: 13px; margin-bottom: 6px; color: var(--gray-700);">wallowing in generic <u>angst</u></div>
                    <div style="font-size: 13px; color: var(--gray-900);">wallowing in generic <u>distress</u></div>
                </div>

                <div class="example-card" style="background: var(--gray-100); padding: 16px;">
                    <div style="font-family: 'IBM Plex Mono', monospace; font-size: 10px; font-weight: 600; color: var(--accent); margin-bottom: 6px; text-transform: uppercase; letter-spacing: 0.05em;">Negation</div>
                    <div style="font-size: 13px; margin-bottom: 6px; color: var(--gray-700);">developed by <u>Golaem</u></div>
                    <div style="font-size: 13px; color: var(--gray-900);">developed by <u>no company, neither Golaem nor any other</u></div>
                </div>

                <!-- Discourse -->
                <div class="example-card" style="background: var(--gray-100); padding: 16px;">
                    <div style="font-family: 'IBM Plex Mono', monospace; font-size: 10px; font-weight: 600; color: var(--accent); margin-bottom: 6px; text-transform: uppercase; letter-spacing: 0.05em;">Discourse Markers</div>
                    <div style="font-size: 13px; margin-bottom: 6px; color: var(--gray-700);"><u>Moreover,</u> Santa is actually innocent</div>
                    <div style="font-size: 13px; color: var(--gray-900);">Santa is actually innocent</div>
                </div>

                <div class="example-card" style="background: var(--gray-100); padding: 16px;">
                    <div style="font-family: 'IBM Plex Mono', monospace; font-size: 10px; font-weight: 600; color: var(--accent); margin-bottom: 6px; text-transform: uppercase; letter-spacing: 0.05em;">Sentiment/Appraisal</div>
                    <div style="font-size: 13px; margin-bottom: 6px; color: var(--gray-700);">Loyalists <u>recruited</u> from Queens County</div>
                    <div style="font-size: 13px; color: var(--gray-900);">Loyalists <u>reluctantly recruited</u> from Queens County</div>
                </div>

                <!-- Varieties -->
                <div class="example-card" style="background: var(--gray-100); padding: 16px;">
                    <div style="font-family: 'IBM Plex Mono', monospace; font-size: 10px; font-weight: 600; color: var(--accent); margin-bottom: 6px; text-transform: uppercase; letter-spacing: 0.05em;">Dialectal</div>
                    <div style="font-size: 13px; margin-bottom: 6px; color: var(--gray-700);">that <u>sounds delicious</u> to me!</div>
                    <div style="font-size: 13px; color: var(--gray-900);">that <u>sounds shiok lah</u>!</div>
                </div>

                <div class="example-card" style="background: var(--gray-100); padding: 16px;">
                    <div style="font-family: 'IBM Plex Mono', monospace; font-size: 10px; font-weight: 600; color: var(--accent); margin-bottom: 6px; text-transform: uppercase; letter-spacing: 0.05em;">Casual Style</div>
                    <div style="font-size: 13px; margin-bottom: 6px; color: var(--gray-700);">a <u>1945</u> British comedy-drama <u>film</u></div>
                    <div style="font-size: 13px; color: var(--gray-900);">a <u>'45</u> British comedy-drama <u>flick</u></div>
                </div>

                <!-- Biases -->
                <div class="example-card" style="background: var(--gray-100); padding: 16px;">
                    <div style="font-family: 'IBM Plex Mono', monospace; font-size: 10px; font-weight: 600; color: var(--accent); margin-bottom: 6px; text-transform: uppercase; letter-spacing: 0.05em;">Temporal Bias</div>
                    <div style="font-size: 13px; margin-bottom: 6px; color: var(--gray-700);">a gold-digging <u>villainness</u></div>
                    <div style="font-size: 13px; color: var(--gray-900);">a gold-digging <u>villainess</u></div>
                </div>

                <div class="example-card" style="background: var(--gray-100); padding: 16px;">
                    <div style="font-family: 'IBM Plex Mono', monospace; font-size: 10px; font-weight: 600; color: var(--accent); margin-bottom: 6px; text-transform: uppercase; letter-spacing: 0.05em;">Geographical Bias</div>
                    <div style="font-size: 13px; margin-bottom: 6px; color: var(--gray-700);">The <u>American</u> fishing community</div>
                    <div style="font-size: 13px; color: var(--gray-900);">The <u>Nauruan</u> fishing community</div>
                </div>

                <div class="example-card" style="background: var(--gray-100); padding: 16px;">
                    <div style="font-family: 'IBM Plex Mono', monospace; font-size: 10px; font-weight: 600; color: var(--accent); margin-bottom: 6px; text-transform: uppercase; letter-spacing: 0.05em;">Length Bias</div>
                    <div style="font-size: 13px; margin-bottom: 6px; color: var(--gray-700);">He went on to produce Kim Fowley and the BMX Bandits</div>
                    <div style="font-size: 13px; color: var(--gray-900);">He produced Kim Fowley and BMX Bandits</div>
                </div>
            </div>
        </div>
    </section>

    <section id="try-it">
        <div class="container">
            <div class="section-title">Try It</div>
            <h2>Flukify Your Text</h2>
            <p>Apply FLUKE modifications using your OpenAI API key. Your key is used directly in-browser and never stored.</p>

            <div class="demo-tabs">
                <button class="demo-tab active" data-panel="single-panel">Single Text</button>
                <button class="demo-tab" data-panel="batch-panel">Batch Dataset</button>
            </div>

            <!-- Single Text Panel -->
            <div class="demo-panel active" id="single-panel">
                <div class="demo-container">
                    <div class="demo-input">
                        <label class="demo-label">Input Text</label>
                        <textarea class="demo-textarea" id="demo-input" placeholder="Enter text to modify...">The quick brown fox jumps over the lazy dog.</textarea>
                    </div>
                    <div class="demo-output">
                        <label class="demo-label">Modified Text</label>
                        <textarea class="demo-textarea output" id="demo-output" readonly placeholder="Modified text will appear here..."></textarea>
                        <div class="demo-meta" id="demo-meta">
                            <div class="demo-meta-item"><span class="demo-meta-label">Type:</span> <span id="meta-type"></span></div>
                            <div class="demo-meta-item"><span class="demo-meta-label">Rationale:</span> <span id="meta-rationale"></span></div>
                        </div>
                    </div>
                </div>

                <div class="demo-controls">
                    <select class="demo-select" id="demo-mod">
                        <optgroup label="Orthography">
                            <option value="capitalization">Capitalization</option>
                            <option value="punctuation">Punctuation</option>
                            <option value="typo">Spelling (Typo)</option>
                        </optgroup>
                        <optgroup label="Morphology">
                            <option value="derivation">Derivation</option>
                            <option value="compound">Compound Words</option>
                        </optgroup>
                        <optgroup label="Syntax">
                            <option value="active_to_passive">Active to Passive</option>
                            <option value="grammatical_role">Grammatical Role</option>
                            <option value="coordinating_conjunction">Coordinating Conjunction</option>
                        </optgroup>
                        <optgroup label="Semantics">
                            <option value="concept_replacement">Concept Replacement</option>
                            <option value="negation" selected>Negation</option>
                        </optgroup>
                        <optgroup label="Discourse">
                            <option value="discourse_markers">Discourse Markers</option>
                            <option value="sentiment">Sentiment</option>
                        </optgroup>
                        <optgroup label="Varieties">
                            <option value="dialectal">Dialectal</option>
                            <option value="casual">Casual/Formal</option>
                        </optgroup>
                        <optgroup label="Biases">
                            <option value="temporal_bias">Temporal Bias</option>
                            <option value="geographical_bias">Geographical Bias</option>
                            <option value="length_bias">Length Bias</option>
                        </optgroup>
                    </select>
                    <input type="password" class="demo-api-key" id="demo-api-key" placeholder="OpenAI API Key (sk-...)">
                    <button class="demo-btn" id="demo-btn" onclick="runFlukify()">Apply Modification</button>
                </div>

                <div class="demo-status" id="demo-status"></div>
            </div>

            <!-- Batch Dataset Panel -->
            <div class="demo-panel" id="batch-panel">
                <div class="file-upload" id="file-upload" onclick="document.getElementById('file-input').click()">
                    <input type="file" id="file-input" accept=".csv,.jsonl,.json" onchange="handleFileSelect(this)">
                    <div class="file-upload-text" id="file-upload-text">
                        <strong>Click to upload</strong> or drag and drop<br>
                        CSV or JSONL file
                    </div>
                </div>

                <div class="batch-row">
                    <div class="batch-field">
                        <label for="batch-text-field">Text Column Name</label>
                        <input type="text" id="batch-text-field" value="text" placeholder="text">
                    </div>
                    <div class="batch-field">
                        <label for="batch-sample">Sample Size (optional)</label>
                        <input type="number" id="batch-sample" min="1" placeholder="All rows">
                    </div>
                </div>

                <div class="batch-row">
                    <div class="batch-field">
                        <label for="batch-api-key">OpenAI API Key</label>
                        <input type="password" id="batch-api-key" placeholder="sk-...">
                    </div>
                    <div class="batch-field">
                        <label for="batch-model">Model</label>
                        <select id="batch-model">
                            <option value="gpt-4o-mini" selected>gpt-4o-mini (fast, cheap)</option>
                            <option value="gpt-4o">gpt-4o (better quality)</option>
                        </select>
                    </div>
                </div>

                <label class="demo-label" style="margin-top: 20px;">Select Modifications</label>

                <div class="mod-category-label">Orthography</div>
                <div class="mod-checkboxes">
                    <label class="mod-checkbox"><input type="checkbox" name="batch-mod" value="capitalization" checked> Capitalization</label>
                    <label class="mod-checkbox"><input type="checkbox" name="batch-mod" value="punctuation" checked> Punctuation</label>
                    <label class="mod-checkbox"><input type="checkbox" name="batch-mod" value="typo" checked> Spelling (Typo)</label>
                </div>

                <div class="mod-category-label">Morphology</div>
                <div class="mod-checkboxes">
                    <label class="mod-checkbox"><input type="checkbox" name="batch-mod" value="derivation" checked> Derivation</label>
                    <label class="mod-checkbox"><input type="checkbox" name="batch-mod" value="compound" checked> Compound Words</label>
                </div>

                <div class="mod-category-label">Syntax</div>
                <div class="mod-checkboxes">
                    <label class="mod-checkbox"><input type="checkbox" name="batch-mod" value="active_to_passive" checked> Active to Passive</label>
                    <label class="mod-checkbox"><input type="checkbox" name="batch-mod" value="grammatical_role" checked> Grammatical Role</label>
                    <label class="mod-checkbox"><input type="checkbox" name="batch-mod" value="coordinating_conjunction" checked> Coordinating Conjunction</label>
                </div>

                <div class="mod-category-label">Semantics</div>
                <div class="mod-checkboxes">
                    <label class="mod-checkbox"><input type="checkbox" name="batch-mod" value="concept_replacement" checked> Concept Replacement</label>
                    <label class="mod-checkbox"><input type="checkbox" name="batch-mod" value="negation" checked> Negation</label>
                </div>

                <div class="mod-category-label">Discourse</div>
                <div class="mod-checkboxes">
                    <label class="mod-checkbox"><input type="checkbox" name="batch-mod" value="discourse_markers" checked> Discourse Markers</label>
                    <label class="mod-checkbox"><input type="checkbox" name="batch-mod" value="sentiment" checked> Sentiment</label>
                </div>

                <div class="mod-category-label">Varieties</div>
                <div class="mod-checkboxes">
                    <label class="mod-checkbox"><input type="checkbox" name="batch-mod" value="dialectal" checked> Dialectal</label>
                    <label class="mod-checkbox"><input type="checkbox" name="batch-mod" value="casual" checked> Casual/Formal</label>
                </div>

                <div class="mod-category-label">Biases</div>
                <div class="mod-checkboxes">
                    <label class="mod-checkbox"><input type="checkbox" name="batch-mod" value="temporal_bias" checked> Temporal Bias</label>
                    <label class="mod-checkbox"><input type="checkbox" name="batch-mod" value="geographical_bias" checked> Geographical Bias</label>
                    <label class="mod-checkbox"><input type="checkbox" name="batch-mod" value="length_bias" checked> Length Bias</label>
                </div>

                <div class="batch-actions">
                    <button onclick="selectAllMods()">Select All</button>
                    <button onclick="selectNoneMods()">Select None</button>
                </div>

                <button class="demo-btn" id="batch-btn" onclick="runBatchFlukify()" style="width: 100%;">Process Dataset</button>

                <div class="progress-container" id="progress-container">
                    <div class="progress-bar">
                        <div class="progress-fill" id="progress-fill"></div>
                    </div>
                    <div class="progress-text" id="progress-text">Processing...</div>
                </div>

                <div class="demo-status" id="batch-status"></div>
            </div>

            <div class="demo-note">
                <strong>Note:</strong> API calls are made directly from your browser. Your API key is never stored or sent anywhere except OpenAI.
                For programmatic use, see the <a href="https://github.com/joey234/fluke/tree/main/flukify" style="color: var(--blue);">Flukify CLI tool</a>.
            </div>
        </div>
    </section>

    <section id="findings">
        <div class="container">
            <div class="section-title">Key Findings</div>
            <div class="findings-grid">
                <div class="finding">
                    <div class="finding-num">01</div>
                    <h3>Task-Dependent Impact</h3>
                    <p>Some tests are critical for certain tasks but irrelevant for others. Negation devastates Dialogue (30%) but barely affects NER (7.4%).</p>
                </div>
                <div class="finding">
                    <div class="finding-num">02</div>
                    <h3>Reasoning ≠ Robustness</h3>
                    <p>Reasoning LLMs (GPT-5, DeepSeek R1) sometimes show less robustness than base models on classification tasks.</p>
                </div>
                <div class="finding">
                    <div class="finding-num">03</div>
                    <h3>Natural > Adversarial</h3>
                    <p>Fluent modifications (syntax, style, dialect) cause more brittleness than corruption tests like letter flipping.</p>
                </div>
                <div class="finding">
                    <div class="finding-num">04</div>
                    <h3>Generation ≠ Understanding</h3>
                    <p>A model's ability to use a linguistic feature in generation doesn't predict its robustness to that feature.</p>
                </div>
            </div>
        </div>
    </section>

    <section id="tasks">
        <div class="container">
            <div class="section-title">Evaluation Setup</div>
            <h2>Six Tasks, Eight Models, 17 Tests</h2>
            <p>We evaluate across classification and generation tasks using PLMs, base LLMs, and reasoning LLMs.</p>

            <div class="task-grid">
                <div class="task">
                    <span class="task-type cls">Classification</span>
                    <h4>Coreference</h4>
                    <p>KnowRef dataset</p>
                </div>
                <div class="task">
                    <span class="task-type cls">Classification</span>
                    <h4>Dialogue</h4>
                    <p>DECODE dataset</p>
                </div>
                <div class="task">
                    <span class="task-type cls">Classification</span>
                    <h4>NER</h4>
                    <p>Few-NERD dataset</p>
                </div>
                <div class="task">
                    <span class="task-type cls">Classification</span>
                    <h4>Sentiment</h4>
                    <p>SST-2 dataset</p>
                </div>
                <div class="task">
                    <span class="task-type gen">Generation</span>
                    <h4>Math (GSM)</h4>
                    <p>GSM8K dataset</p>
                </div>
                <div class="task">
                    <span class="task-type gen">Generation</span>
                    <h4>Instruction</h4>
                    <p>IFEval benchmark</p>
                </div>
            </div>

            <div class="section-title" style="margin-top: 40px;">Models</div>
            <div class="model-grid">
                <span class="model">BERT</span>
                <span class="model">GPT-2</span>
                <span class="model">T5</span>
                <span class="model">GPT-4o</span>
                <span class="model">Claude 3.5</span>
                <span class="model">Llama 3.1</span>
                <span class="model reasoning">GPT-5</span>
                <span class="model reasoning">DeepSeek R1</span>
            </div>
        </div>
    </section>

    <section id="results">
        <div class="container">
            <div class="section-title">Results</div>
            <h2>Unrobustness by Task</h2>
            <p>Unrobustness (U%) measures prediction changes between original and modified instances. Higher = more brittle. Select a task to view detailed results.</p>

            <div class="tabs" role="tablist">
                <button class="tab active" data-tab="coref" role="tab">Coreference</button>
                <button class="tab" data-tab="dialogue" role="tab">Dialogue</button>
                <button class="tab" data-tab="ner" role="tab">NER</button>
                <button class="tab" data-tab="sentiment" role="tab">Sentiment</button>
                <button class="tab" data-tab="gsm" role="tab">GSM</button>
                <button class="tab" data-tab="ifeval" role="tab">IFEval</button>
                <button class="tab" data-tab="scaling" role="tab">Scaling</button>
            </div>

            <!-- Coreference -->
            <div class="tab-panel active" id="coref" role="tabpanel">
                <h3>Coreference Resolution <span class="task-badge cls">Classification</span></h3>
                <div class="table-wrapper">
                    <table>
                        <thead>
                            <tr><th>Category</th><th>Modification</th><th>BERT</th><th>GPT-2</th><th>T5</th><th>GPT-4o</th><th>Claude</th><th>Llama</th><th>GPT-5</th><th>DS R1</th><th>Avg</th></tr>
                        </thead>
                        <tbody>
                            <tr><td class="cat-cell" rowspan="3">Bias</td><td class="mod-cell">Temporal</td><td class="num-cell">9.0</td><td class="num-cell">4.0</td><td class="num-cell">6.0</td><td class="num-cell">8.0</td><td class="num-cell low">1.0</td><td class="num-cell">7.0</td><td class="num-cell">3.0</td><td class="num-cell">8.0</td><td class="num-cell">5.8</td></tr>
                            <tr><td class="mod-cell">Geographical</td><td class="num-cell">8.0</td><td class="num-cell med">14.0</td><td class="num-cell">9.0</td><td class="num-cell med">10.0</td><td class="num-cell">4.0</td><td class="num-cell">5.0</td><td class="num-cell">6.0</td><td class="num-cell med">10.0</td><td class="num-cell">8.2</td></tr>
                            <tr><td class="mod-cell">Length</td><td class="num-cell high">19.2</td><td class="num-cell high">15.2</td><td class="num-cell med">14.1</td><td class="num-cell high">15.2</td><td class="num-cell high">20.2</td><td class="num-cell high">17.2</td><td class="num-cell">8.1</td><td class="num-cell med">13.1</td><td class="num-cell high">15.3</td></tr>
                            <tr><td class="cat-cell" rowspan="3">Orthography</td><td class="mod-cell">Spelling</td><td class="num-cell med">11.2</td><td class="num-cell">3.1</td><td class="num-cell">7.1</td><td class="num-cell">5.1</td><td class="num-cell low">2.0</td><td class="num-cell">4.1</td><td class="num-cell">7.1</td><td class="num-cell">4.1</td><td class="num-cell">5.5</td></tr>
                            <tr><td class="mod-cell">Capitalization</td><td class="num-cell high">15.2</td><td class="num-cell med">14.1</td><td class="num-cell">7.1</td><td class="num-cell">7.1</td><td class="num-cell">4.0</td><td class="num-cell">5.1</td><td class="num-cell low">2.0</td><td class="num-cell">6.1</td><td class="num-cell">7.6</td></tr>
                            <tr><td class="mod-cell">Punctuation</td><td class="num-cell low">1.0</td><td class="num-cell">7.1</td><td class="num-cell low">1.0</td><td class="num-cell low">1.0</td><td class="num-cell">3.0</td><td class="num-cell low">1.0</td><td class="num-cell low">2.0</td><td class="num-cell">4.0</td><td class="num-cell low">2.5</td></tr>
                            <tr><td class="cat-cell" rowspan="2">Morphology</td><td class="mod-cell">Derivation</td><td class="num-cell">4.1</td><td class="num-cell">3.1</td><td class="num-cell">5.1</td><td class="num-cell">4.1</td><td class="num-cell low">1.0</td><td class="num-cell low">1.0</td><td class="num-cell">5.1</td><td class="num-cell low">2.0</td><td class="num-cell">3.2</td></tr>
                            <tr><td class="mod-cell">Compound</td><td class="num-cell">6.2</td><td class="num-cell">4.2</td><td class="num-cell">3.1</td><td class="num-cell">5.2</td><td class="num-cell">6.2</td><td class="num-cell">6.2</td><td class="num-cell">3.1</td><td class="num-cell">4.2</td><td class="num-cell">4.8</td></tr>
                            <tr><td class="cat-cell" rowspan="3">Syntax</td><td class="mod-cell">Voice</td><td class="num-cell high">35.8</td><td class="num-cell high">34.7</td><td class="num-cell high">41.1</td><td class="num-cell high">26.3</td><td class="num-cell high">15.8</td><td class="num-cell high">30.5</td><td class="num-cell">9.5</td><td class="num-cell high">15.8</td><td class="num-cell high">26.2</td></tr>
                            <tr><td class="mod-cell">Grammar</td><td class="num-cell high">30.6</td><td class="num-cell high">27.8</td><td class="num-cell high">19.4</td><td class="num-cell high">22.2</td><td class="num-cell high">18.1</td><td class="num-cell high">19.4</td><td class="num-cell high">16.7</td><td class="num-cell high">20.8</td><td class="num-cell high">21.9</td></tr>
                            <tr><td class="mod-cell">Conjunction</td><td class="num-cell">5.2</td><td class="num-cell med">10.3</td><td class="num-cell">8.2</td><td class="num-cell">8.2</td><td class="num-cell">4.1</td><td class="num-cell">7.2</td><td class="num-cell">5.2</td><td class="num-cell">6.2</td><td class="num-cell">6.8</td></tr>
                            <tr><td class="cat-cell" rowspan="2">Semantics</td><td class="mod-cell">Concept</td><td class="num-cell">8.0</td><td class="num-cell">3.0</td><td class="num-cell">5.0</td><td class="num-cell med">11.0</td><td class="num-cell high">18.0</td><td class="num-cell">9.0</td><td class="num-cell med">10.0</td><td class="num-cell med">10.0</td><td class="num-cell">9.2</td></tr>
                            <tr><td class="mod-cell">Negation</td><td class="num-cell high">25.5</td><td class="num-cell high">23.5</td><td class="num-cell high">24.5</td><td class="num-cell high">21.4</td><td class="num-cell high">24.5</td><td class="num-cell high">22.4</td><td class="num-cell high">22.4</td><td class="num-cell high">30.6</td><td class="num-cell high">24.4</td></tr>
                            <tr><td class="cat-cell" rowspan="2">Discourse</td><td class="mod-cell">Markers</td><td class="num-cell">8.0</td><td class="num-cell">6.0</td><td class="num-cell">8.0</td><td class="num-cell high">19.0</td><td class="num-cell med">10.0</td><td class="num-cell">7.0</td><td class="num-cell">9.0</td><td class="num-cell med">11.0</td><td class="num-cell">9.8</td></tr>
                            <tr><td class="mod-cell">Appraisal</td><td class="num-cell">5.0</td><td class="num-cell">8.0</td><td class="num-cell">4.0</td><td class="num-cell">8.0</td><td class="num-cell">7.0</td><td class="num-cell">9.0</td><td class="num-cell">5.0</td><td class="num-cell">7.0</td><td class="num-cell">6.6</td></tr>
                            <tr><td class="cat-cell" rowspan="2">Varieties</td><td class="mod-cell">Style</td><td class="num-cell high">16.0</td><td class="num-cell high">19.0</td><td class="num-cell high">18.0</td><td class="num-cell high">19.0</td><td class="num-cell med">14.0</td><td class="num-cell med">14.0</td><td class="num-cell med">14.0</td><td class="num-cell med">12.0</td><td class="num-cell high">15.8</td></tr>
                            <tr><td class="mod-cell">Dialect</td><td class="num-cell">8.3</td><td class="num-cell high">26.9</td><td class="num-cell high">22.2</td><td class="num-cell high">24.5</td><td class="num-cell med">11.8</td><td class="num-cell high">16.7</td><td class="num-cell low">2.9</td><td class="num-cell med">12.7</td><td class="num-cell high">15.8</td></tr>
                            <tr class="avg-row"><td class="cat-cell">Average</td><td></td><td class="num-cell med">12.7</td><td class="num-cell med">13.2</td><td class="num-cell med">11.9</td><td class="num-cell med">12.7</td><td class="num-cell">9.7</td><td class="num-cell med">10.7</td><td class="num-cell">7.7</td><td class="num-cell med">10.5</td><td class="num-cell med">11.1</td></tr>
                        </tbody>
                    </table>
                </div>
                <p class="table-caption">Voice and Grammar modifications cause highest unrobustness (26%, 22%). GPT-5 shows best overall robustness (7.7% avg).</p>
            </div>

            <!-- Dialogue -->
            <div class="tab-panel" id="dialogue" role="tabpanel">
                <h3>Dialogue Understanding <span class="task-badge cls">Classification</span></h3>
                <div class="table-wrapper">
                    <table>
                        <thead>
                            <tr><th>Category</th><th>Modification</th><th>BERT</th><th>GPT-2</th><th>T5</th><th>GPT-4o</th><th>Claude</th><th>Llama</th><th>GPT-5</th><th>DS R1</th><th>Avg</th></tr>
                        </thead>
                        <tbody>
                            <tr><td class="cat-cell" rowspan="3">Bias</td><td class="mod-cell">Temporal</td><td class="num-cell">8.0</td><td class="num-cell">6.0</td><td class="num-cell">7.0</td><td class="num-cell low">2.0</td><td class="num-cell">5.0</td><td class="num-cell low">1.0</td><td class="num-cell">3.0</td><td class="num-cell low">2.0</td><td class="num-cell">4.2</td></tr>
                            <tr><td class="mod-cell">Geographical</td><td class="num-cell">6.5</td><td class="num-cell">8.7</td><td class="num-cell med">12.0</td><td class="num-cell med">13.0</td><td class="num-cell high">15.2</td><td class="num-cell med">12.0</td><td class="num-cell high">18.5</td><td class="num-cell med">13.0</td><td class="num-cell med">12.4</td></tr>
                            <tr><td class="mod-cell">Length</td><td class="num-cell med">10.0</td><td class="num-cell">6.0</td><td class="num-cell">5.0</td><td class="num-cell">4.0</td><td class="num-cell">6.0</td><td class="num-cell low">1.0</td><td class="num-cell">6.0</td><td class="num-cell">7.0</td><td class="num-cell">5.6</td></tr>
                            <tr><td class="cat-cell" rowspan="3">Orthography</td><td class="mod-cell">Spelling</td><td class="num-cell">6.0</td><td class="num-cell">6.0</td><td class="num-cell">4.0</td><td class="num-cell">8.0</td><td class="num-cell">3.0</td><td class="num-cell low">2.0</td><td class="num-cell low">1.0</td><td class="num-cell">6.0</td><td class="num-cell">4.5</td></tr>
                            <tr><td class="mod-cell">Capitalization</td><td class="num-cell low">0.0</td><td class="num-cell">6.2</td><td class="num-cell">6.2</td><td class="num-cell">3.1</td><td class="num-cell low">2.1</td><td class="num-cell low">2.1</td><td class="num-cell">4.2</td><td class="num-cell low">1.0</td><td class="num-cell">3.1</td></tr>
                            <tr><td class="mod-cell">Punctuation</td><td class="num-cell">4.0</td><td class="num-cell low">2.0</td><td class="num-cell">8.0</td><td class="num-cell">3.0</td><td class="num-cell">3.0</td><td class="num-cell low">1.0</td><td class="num-cell">5.0</td><td class="num-cell low">2.0</td><td class="num-cell">3.5</td></tr>
                            <tr><td class="cat-cell" rowspan="2">Morphology</td><td class="mod-cell">Derivation</td><td class="num-cell low">0.0</td><td class="num-cell low">2.2</td><td class="num-cell low">1.1</td><td class="num-cell">4.3</td><td class="num-cell">5.4</td><td class="num-cell low">1.1</td><td class="num-cell">5.4</td><td class="num-cell">6.5</td><td class="num-cell">3.2</td></tr>
                            <tr><td class="mod-cell">Compound</td><td class="num-cell">6.0</td><td class="num-cell">4.0</td><td class="num-cell">3.0</td><td class="num-cell">4.0</td><td class="num-cell">7.0</td><td class="num-cell low">1.0</td><td class="num-cell">8.0</td><td class="num-cell">6.0</td><td class="num-cell">4.9</td></tr>
                            <tr><td class="cat-cell" rowspan="3">Syntax</td><td class="mod-cell">Voice</td><td class="num-cell">9.0</td><td class="num-cell med">11.0</td><td class="num-cell">7.0</td><td class="num-cell">7.0</td><td class="num-cell low">2.0</td><td class="num-cell">3.0</td><td class="num-cell">9.0</td><td class="num-cell">5.0</td><td class="num-cell">6.6</td></tr>
                            <tr><td class="mod-cell">Grammar</td><td class="num-cell med">14.3</td><td class="num-cell med">12.9</td><td class="num-cell">7.1</td><td class="num-cell high">20.6</td><td class="num-cell">7.4</td><td class="num-cell med">11.8</td><td class="num-cell high">16.2</td><td class="num-cell high">19.1</td><td class="num-cell med">13.7</td></tr>
                            <tr><td class="mod-cell">Conjunction</td><td class="num-cell">5.0</td><td class="num-cell">4.0</td><td class="num-cell">7.0</td><td class="num-cell">6.0</td><td class="num-cell low">1.0</td><td class="num-cell low">2.0</td><td class="num-cell">4.0</td><td class="num-cell">4.0</td><td class="num-cell">4.1</td></tr>
                            <tr><td class="cat-cell" rowspan="2">Semantics</td><td class="mod-cell">Concept</td><td class="num-cell">7.0</td><td class="num-cell">5.0</td><td class="num-cell">4.0</td><td class="num-cell">8.0</td><td class="num-cell">7.0</td><td class="num-cell low">2.0</td><td class="num-cell med">10.0</td><td class="num-cell">6.0</td><td class="num-cell">6.1</td></tr>
                            <tr><td class="mod-cell">Negation</td><td class="num-cell high">29.0</td><td class="num-cell high">39.0</td><td class="num-cell high">31.0</td><td class="num-cell high">31.0</td><td class="num-cell high">30.0</td><td class="num-cell high">30.0</td><td class="num-cell high">25.0</td><td class="num-cell high">25.0</td><td class="num-cell high">30.0</td></tr>
                            <tr><td class="cat-cell" rowspan="2">Discourse</td><td class="mod-cell">Markers</td><td class="num-cell">5.7</td><td class="num-cell">9.2</td><td class="num-cell">3.4</td><td class="num-cell">3.4</td><td class="num-cell low">2.3</td><td class="num-cell">3.4</td><td class="num-cell">5.7</td><td class="num-cell">5.7</td><td class="num-cell">4.9</td></tr>
                            <tr><td class="mod-cell">Appraisal</td><td class="num-cell">6.0</td><td class="num-cell med">10.0</td><td class="num-cell">5.0</td><td class="num-cell">7.0</td><td class="num-cell">6.0</td><td class="num-cell">4.0</td><td class="num-cell med">10.0</td><td class="num-cell med">11.0</td><td class="num-cell">7.4</td></tr>
                            <tr><td class="cat-cell" rowspan="2">Varieties</td><td class="mod-cell">Style</td><td class="num-cell med">12.0</td><td class="num-cell med">10.0</td><td class="num-cell med">12.0</td><td class="num-cell">6.0</td><td class="num-cell">4.0</td><td class="num-cell low">2.0</td><td class="num-cell">6.0</td><td class="num-cell">6.0</td><td class="num-cell">7.2</td></tr>
                            <tr><td class="mod-cell">Dialect</td><td class="num-cell high">20.8</td><td class="num-cell">5.7</td><td class="num-cell">9.4</td><td class="num-cell med">11.3</td><td class="num-cell high">15.1</td><td class="num-cell">7.5</td><td class="num-cell">5.7</td><td class="num-cell med">13.2</td><td class="num-cell med">11.1</td></tr>
                            <tr class="avg-row"><td class="cat-cell">Average</td><td></td><td class="num-cell">8.8</td><td class="num-cell">8.7</td><td class="num-cell">7.8</td><td class="num-cell">8.3</td><td class="num-cell">7.1</td><td class="num-cell">5.1</td><td class="num-cell">8.4</td><td class="num-cell">8.2</td><td class="num-cell">7.8</td></tr>
                        </tbody>
                    </table>
                </div>
                <p class="table-caption">Negation causes severe brittleness (30% avg). Llama 3.1 shows best robustness (5.1% avg) on dialogue.</p>
            </div>

            <!-- NER -->
            <div class="tab-panel" id="ner" role="tabpanel">
                <h3>Named Entity Recognition <span class="task-badge cls">Classification</span></h3>
                <div class="table-wrapper">
                    <table>
                        <thead>
                            <tr><th>Category</th><th>Modification</th><th>BERT</th><th>GPT-2</th><th>T5</th><th>GPT-4o</th><th>Claude</th><th>Llama</th><th>GPT-5</th><th>DS R1</th><th>Avg</th></tr>
                        </thead>
                        <tbody>
                            <tr><td class="cat-cell" rowspan="3">Bias</td><td class="mod-cell">Temporal</td><td class="num-cell">3.7</td><td class="num-cell">3.0</td><td class="num-cell low">1.2</td><td class="num-cell">6.2</td><td class="num-cell">4.3</td><td class="num-cell low">1.8</td><td class="num-cell">7.7</td><td class="num-cell med">10.6</td><td class="num-cell">4.8</td></tr>
                            <tr><td class="mod-cell">Geographical</td><td class="num-cell high">25.1</td><td class="num-cell high">27.6</td><td class="num-cell high">29.0</td><td class="num-cell high">22.3</td><td class="num-cell high">26.0</td><td class="num-cell high">27.0</td><td class="num-cell high">22.0</td><td class="num-cell high">27.8</td><td class="num-cell high">25.8</td></tr>
                            <tr><td class="mod-cell">Length</td><td class="num-cell med">11.8</td><td class="num-cell med">12.2</td><td class="num-cell med">13.1</td><td class="num-cell med">12.7</td><td class="num-cell high">15.7</td><td class="num-cell">6.4</td><td class="num-cell">9.7</td><td class="num-cell med">12.6</td><td class="num-cell med">11.8</td></tr>
                            <tr><td class="cat-cell" rowspan="3">Orthography</td><td class="mod-cell">Spelling</td><td class="num-cell">4.3</td><td class="num-cell low">2.5</td><td class="num-cell low">1.4</td><td class="num-cell">6.6</td><td class="num-cell">3.0</td><td class="num-cell">3.9</td><td class="num-cell">7.3</td><td class="num-cell med">11.4</td><td class="num-cell">5.0</td></tr>
                            <tr><td class="mod-cell">Capitalization</td><td class="num-cell low">0.9</td><td class="num-cell high">19.3</td><td class="num-cell med">13.1</td><td class="num-cell med">11.3</td><td class="num-cell">8.9</td><td class="num-cell high">15.3</td><td class="num-cell">9.1</td><td class="num-cell med">13.6</td><td class="num-cell med">11.5</td></tr>
                            <tr><td class="mod-cell">Punctuation</td><td class="num-cell">6.5</td><td class="num-cell">3.7</td><td class="num-cell">4.9</td><td class="num-cell">7.1</td><td class="num-cell">9.1</td><td class="num-cell">7.9</td><td class="num-cell">7.8</td><td class="num-cell high">15.0</td><td class="num-cell">7.8</td></tr>
                            <tr><td class="cat-cell" rowspan="2">Morphology</td><td class="mod-cell">Derivation</td><td class="num-cell low">1.9</td><td class="num-cell">4.2</td><td class="num-cell">5.8</td><td class="num-cell">3.7</td><td class="num-cell low">2.0</td><td class="num-cell low">1.3</td><td class="num-cell">9.5</td><td class="num-cell">8.2</td><td class="num-cell">4.6</td></tr>
                            <tr><td class="mod-cell">Compound</td><td class="num-cell">3.1</td><td class="num-cell low">0.6</td><td class="num-cell">5.2</td><td class="num-cell">3.1</td><td class="num-cell low">1.7</td><td class="num-cell low">1.0</td><td class="num-cell">7.0</td><td class="num-cell med">12.9</td><td class="num-cell">4.3</td></tr>
                            <tr><td class="cat-cell" rowspan="3">Syntax</td><td class="mod-cell">Voice</td><td class="num-cell">7.8</td><td class="num-cell med">10.8</td><td class="num-cell">5.7</td><td class="num-cell">7.5</td><td class="num-cell">5.5</td><td class="num-cell">4.5</td><td class="num-cell">8.3</td><td class="num-cell med">11.3</td><td class="num-cell">7.7</td></tr>
                            <tr><td class="mod-cell">Grammar</td><td class="num-cell">8.0</td><td class="num-cell high">15.9</td><td class="num-cell med">10.5</td><td class="num-cell">8.3</td><td class="num-cell">3.5</td><td class="num-cell">5.3</td><td class="num-cell med">10.8</td><td class="num-cell med">12.4</td><td class="num-cell">9.3</td></tr>
                            <tr><td class="mod-cell">Conjunction</td><td class="num-cell">9.1</td><td class="num-cell">7.6</td><td class="num-cell">7.7</td><td class="num-cell">9.4</td><td class="num-cell">7.5</td><td class="num-cell">8.0</td><td class="num-cell med">11.7</td><td class="num-cell med">13.2</td><td class="num-cell">9.3</td></tr>
                            <tr><td class="cat-cell" rowspan="2">Semantics</td><td class="mod-cell">Concept</td><td class="num-cell">5.0</td><td class="num-cell">8.9</td><td class="num-cell">5.3</td><td class="num-cell">6.5</td><td class="num-cell">4.8</td><td class="num-cell">3.9</td><td class="num-cell">8.5</td><td class="num-cell">9.4</td><td class="num-cell">6.5</td></tr>
                            <tr><td class="mod-cell">Negation</td><td class="num-cell">4.8</td><td class="num-cell">5.2</td><td class="num-cell">6.5</td><td class="num-cell">8.2</td><td class="num-cell">3.9</td><td class="num-cell">4.6</td><td class="num-cell med">10.5</td><td class="num-cell high">15.2</td><td class="num-cell">7.4</td></tr>
                            <tr><td class="cat-cell" rowspan="2">Discourse</td><td class="mod-cell">Markers</td><td class="num-cell">4.7</td><td class="num-cell low">1.6</td><td class="num-cell">5.4</td><td class="num-cell low">2.2</td><td class="num-cell low">1.9</td><td class="num-cell">3.2</td><td class="num-cell">6.3</td><td class="num-cell">8.7</td><td class="num-cell">4.2</td></tr>
                            <tr><td class="mod-cell">Appraisal</td><td class="num-cell">5.5</td><td class="num-cell low">2.6</td><td class="num-cell">4.8</td><td class="num-cell">3.2</td><td class="num-cell">3.1</td><td class="num-cell low">2.9</td><td class="num-cell">7.1</td><td class="num-cell med">14.0</td><td class="num-cell">5.4</td></tr>
                            <tr><td class="cat-cell" rowspan="2">Varieties</td><td class="mod-cell">Style</td><td class="num-cell med">11.8</td><td class="num-cell med">12.2</td><td class="num-cell med">13.1</td><td class="num-cell">3.6</td><td class="num-cell">4.8</td><td class="num-cell">6.4</td><td class="num-cell">7.4</td><td class="num-cell med">10.9</td><td class="num-cell">8.8</td></tr>
                            <tr><td class="mod-cell">Dialect</td><td class="num-cell med">12.6</td><td class="num-cell">7.4</td><td class="num-cell">8.4</td><td class="num-cell">5.9</td><td class="num-cell">8.9</td><td class="num-cell">4.7</td><td class="num-cell">7.0</td><td class="num-cell med">13.2</td><td class="num-cell">8.5</td></tr>
                            <tr class="avg-row"><td class="cat-cell">Average</td><td></td><td class="num-cell">7.4</td><td class="num-cell">8.6</td><td class="num-cell">8.3</td><td class="num-cell">7.5</td><td class="num-cell">6.7</td><td class="num-cell">6.4</td><td class="num-cell">9.3</td><td class="num-cell med">13.0</td><td class="num-cell">8.4</td></tr>
                        </tbody>
                    </table>
                </div>
                <p class="table-caption">Geographical bias causes highest NER brittleness (25.8%). DeepSeek R1 shows highest unrobustness (13% avg).</p>
            </div>

            <!-- Sentiment -->
            <div class="tab-panel" id="sentiment" role="tabpanel">
                <h3>Sentiment Analysis <span class="task-badge cls">Classification</span></h3>
                <div class="table-wrapper">
                    <table>
                        <thead>
                            <tr><th>Category</th><th>Modification</th><th>BERT</th><th>GPT-2</th><th>T5</th><th>GPT-4o</th><th>Claude</th><th>Llama</th><th>GPT-5</th><th>DS R1</th><th>Avg</th></tr>
                        </thead>
                        <tbody>
                            <tr><td class="cat-cell" rowspan="3">Bias</td><td class="mod-cell">Temporal</td><td class="num-cell">5.0</td><td class="num-cell">5.0</td><td class="num-cell">3.0</td><td class="num-cell low">0.0</td><td class="num-cell">8.0</td><td class="num-cell low">1.0</td><td class="num-cell">3.0</td><td class="num-cell">3.0</td><td class="num-cell">3.5</td></tr>
                            <tr><td class="mod-cell">Geographical</td><td class="num-cell">5.0</td><td class="num-cell">4.0</td><td class="num-cell">3.0</td><td class="num-cell">9.0</td><td class="num-cell">8.0</td><td class="num-cell">7.0</td><td class="num-cell">4.0</td><td class="num-cell">8.0</td><td class="num-cell">6.0</td></tr>
                            <tr><td class="mod-cell">Length</td><td class="num-cell">3.0</td><td class="num-cell low">2.0</td><td class="num-cell">3.0</td><td class="num-cell">3.0</td><td class="num-cell">9.0</td><td class="num-cell low">2.0</td><td class="num-cell low">1.0</td><td class="num-cell low">1.0</td><td class="num-cell">3.0</td></tr>
                            <tr><td class="cat-cell" rowspan="3">Orthography</td><td class="mod-cell">Spelling</td><td class="num-cell">4.0</td><td class="num-cell">4.0</td><td class="num-cell low">0.0</td><td class="num-cell low">0.0</td><td class="num-cell">6.0</td><td class="num-cell">3.0</td><td class="num-cell low">0.0</td><td class="num-cell low">0.0</td><td class="num-cell low">2.1</td></tr>
                            <tr><td class="mod-cell">Capitalization</td><td class="num-cell low">0.0</td><td class="num-cell">3.0</td><td class="num-cell">3.0</td><td class="num-cell low">1.0</td><td class="num-cell">7.1</td><td class="num-cell">3.0</td><td class="num-cell low">0.0</td><td class="num-cell">3.0</td><td class="num-cell low">2.5</td></tr>
                            <tr><td class="mod-cell">Punctuation</td><td class="num-cell low">1.0</td><td class="num-cell low">2.0</td><td class="num-cell low">0.0</td><td class="num-cell low">1.0</td><td class="num-cell">3.0</td><td class="num-cell">3.0</td><td class="num-cell low">1.0</td><td class="num-cell low">1.0</td><td class="num-cell low">1.5</td></tr>
                            <tr><td class="cat-cell" rowspan="2">Morphology</td><td class="mod-cell">Derivation</td><td class="num-cell">3.4</td><td class="num-cell">5.7</td><td class="num-cell low">2.3</td><td class="num-cell low">2.3</td><td class="num-cell">6.9</td><td class="num-cell low">2.3</td><td class="num-cell">3.4</td><td class="num-cell">4.6</td><td class="num-cell">3.9</td></tr>
                            <tr><td class="mod-cell">Compound</td><td class="num-cell">3.2</td><td class="num-cell">8.4</td><td class="num-cell">3.2</td><td class="num-cell low">2.1</td><td class="num-cell">5.3</td><td class="num-cell low">1.1</td><td class="num-cell">3.2</td><td class="num-cell">4.2</td><td class="num-cell">3.8</td></tr>
                            <tr><td class="cat-cell" rowspan="3">Syntax</td><td class="mod-cell">Voice</td><td class="num-cell">9.0</td><td class="num-cell med">10.0</td><td class="num-cell">9.0</td><td class="num-cell">4.0</td><td class="num-cell med">10.0</td><td class="num-cell">3.0</td><td class="num-cell">5.0</td><td class="num-cell">4.0</td><td class="num-cell">6.8</td></tr>
                            <tr><td class="mod-cell">Grammar</td><td class="num-cell">4.5</td><td class="num-cell med">12.1</td><td class="num-cell">3.0</td><td class="num-cell">4.5</td><td class="num-cell">7.6</td><td class="num-cell">4.5</td><td class="num-cell">4.5</td><td class="num-cell">4.5</td><td class="num-cell">5.7</td></tr>
                            <tr><td class="mod-cell">Conjunction</td><td class="num-cell">3.0</td><td class="num-cell">6.0</td><td class="num-cell low">1.0</td><td class="num-cell low">1.0</td><td class="num-cell">3.0</td><td class="num-cell">3.0</td><td class="num-cell low">0.0</td><td class="num-cell low">0.0</td><td class="num-cell low">2.1</td></tr>
                            <tr><td class="cat-cell" rowspan="2">Semantics</td><td class="mod-cell">Concept</td><td class="num-cell">6.0</td><td class="num-cell">6.0</td><td class="num-cell">5.0</td><td class="num-cell">4.0</td><td class="num-cell">4.0</td><td class="num-cell low">2.0</td><td class="num-cell low">1.0</td><td class="num-cell">5.0</td><td class="num-cell">4.1</td></tr>
                            <tr><td class="mod-cell">Negation</td><td class="num-cell high">22.9</td><td class="num-cell high">20.8</td><td class="num-cell high">25.0</td><td class="num-cell high">16.7</td><td class="num-cell high">17.7</td><td class="num-cell high">15.6</td><td class="num-cell high">16.7</td><td class="num-cell high">17.7</td><td class="num-cell high">19.1</td></tr>
                            <tr><td class="cat-cell" rowspan="2">Discourse</td><td class="mod-cell">Markers</td><td class="num-cell">3.0</td><td class="num-cell">6.1</td><td class="num-cell">4.0</td><td class="num-cell low">1.0</td><td class="num-cell med">12.1</td><td class="num-cell">3.0</td><td class="num-cell low">2.0</td><td class="num-cell">3.0</td><td class="num-cell">4.3</td></tr>
                            <tr><td class="mod-cell">Sentiment</td><td class="num-cell high">19.0</td><td class="num-cell high">16.0</td><td class="num-cell med">12.0</td><td class="num-cell med">14.0</td><td class="num-cell high">15.0</td><td class="num-cell high">16.0</td><td class="num-cell med">11.0</td><td class="num-cell med">10.0</td><td class="num-cell med">14.1</td></tr>
                            <tr><td class="cat-cell" rowspan="2">Varieties</td><td class="mod-cell">Casual</td><td class="num-cell">9.0</td><td class="num-cell">9.0</td><td class="num-cell">5.0</td><td class="num-cell">3.0</td><td class="num-cell">7.0</td><td class="num-cell">6.0</td><td class="num-cell">3.0</td><td class="num-cell low">2.0</td><td class="num-cell">5.5</td></tr>
                            <tr><td class="mod-cell">Dialect</td><td class="num-cell">9.8</td><td class="num-cell">9.8</td><td class="num-cell">7.8</td><td class="num-cell">4.9</td><td class="num-cell">6.9</td><td class="num-cell">5.9</td><td class="num-cell low">2.9</td><td class="num-cell">3.9</td><td class="num-cell">6.5</td></tr>
                            <tr class="avg-row"><td class="cat-cell">Average</td><td></td><td class="num-cell">6.5</td><td class="num-cell">7.6</td><td class="num-cell">5.3</td><td class="num-cell">4.2</td><td class="num-cell">8.0</td><td class="num-cell">4.8</td><td class="num-cell">3.6</td><td class="num-cell">4.4</td><td class="num-cell">5.6</td></tr>
                        </tbody>
                    </table>
                </div>
                <p class="table-caption">Negation (19.1%) and Sentiment shifts (14.1%) cause most brittleness. GPT-5 shows best robustness (3.6%).</p>
            </div>

            <!-- GSM -->
            <div class="tab-panel" id="gsm" role="tabpanel">
                <h3>Grade School Math <span class="task-badge gen">Generation</span></h3>
                <div class="table-wrapper">
                    <table>
                        <thead>
                            <tr><th>Category</th><th>Modification</th><th>GPT-4o</th><th>Claude-3.5</th><th>Llama 3.1</th><th>GPT-5</th><th>DS R1</th><th>Avg</th></tr>
                        </thead>
                        <tbody>
                            <tr><td class="cat-cell" rowspan="3">Bias</td><td class="mod-cell">Temporal</td><td class="num-cell low">1.0</td><td class="num-cell low">2.0</td><td class="num-cell">4.0</td><td class="num-cell low">0.0</td><td class="num-cell low">1.0</td><td class="num-cell low">1.6</td></tr>
                            <tr><td class="mod-cell">Geographical</td><td class="num-cell">5.0</td><td class="num-cell">5.0</td><td class="num-cell">7.0</td><td class="num-cell low">1.0</td><td class="num-cell low">2.0</td><td class="num-cell">4.0</td></tr>
                            <tr><td class="mod-cell">Length</td><td class="num-cell">4.0</td><td class="num-cell low">2.0</td><td class="num-cell low">2.0</td><td class="num-cell low">0.0</td><td class="num-cell low">2.0</td><td class="num-cell low">2.0</td></tr>
                            <tr><td class="cat-cell" rowspan="3">Orthography</td><td class="mod-cell">Spelling</td><td class="num-cell low">1.0</td><td class="num-cell low">0.0</td><td class="num-cell low">2.0</td><td class="num-cell low">1.0</td><td class="num-cell low">0.0</td><td class="num-cell low">0.8</td></tr>
                            <tr><td class="mod-cell">Capitalization</td><td class="num-cell">3.0</td><td class="num-cell low">1.0</td><td class="num-cell">5.0</td><td class="num-cell low">1.0</td><td class="num-cell low">1.0</td><td class="num-cell low">2.2</td></tr>
                            <tr><td class="mod-cell">Punctuation</td><td class="num-cell low">0.0</td><td class="num-cell low">0.0</td><td class="num-cell">5.0</td><td class="num-cell low">1.0</td><td class="num-cell low">1.0</td><td class="num-cell low">1.4</td></tr>
                            <tr><td class="cat-cell" rowspan="2">Semantics</td><td class="mod-cell">Concept</td><td class="num-cell low">1.0</td><td class="num-cell low">0.0</td><td class="num-cell">5.0</td><td class="num-cell low">2.0</td><td class="num-cell low">1.0</td><td class="num-cell low">1.8</td></tr>
                            <tr><td class="mod-cell">Negation</td><td class="num-cell high">15.0</td><td class="num-cell high">15.0</td><td class="num-cell high">18.0</td><td class="num-cell">7.0</td><td class="num-cell">9.0</td><td class="num-cell med">12.8</td></tr>
                            <tr><td class="cat-cell">Discourse</td><td class="mod-cell">Appraisal</td><td class="num-cell low">0.0</td><td class="num-cell low">0.0</td><td class="num-cell low">1.0</td><td class="num-cell low">1.0</td><td class="num-cell low">1.0</td><td class="num-cell low">0.6</td></tr>
                            <tr><td class="cat-cell" rowspan="2">Varieties</td><td class="mod-cell">Style</td><td class="num-cell">4.0</td><td class="num-cell">3.0</td><td class="num-cell">6.0</td><td class="num-cell">4.0</td><td class="num-cell">3.0</td><td class="num-cell">4.0</td></tr>
                            <tr><td class="mod-cell">Dialect</td><td class="num-cell low">2.0</td><td class="num-cell">4.0</td><td class="num-cell">6.0</td><td class="num-cell low">1.0</td><td class="num-cell low">2.0</td><td class="num-cell">3.0</td></tr>
                            <tr><td class="cat-cell" rowspan="2">Syntax</td><td class="mod-cell">Conjunction</td><td class="num-cell low">0.0</td><td class="num-cell low">1.0</td><td class="num-cell">4.0</td><td class="num-cell low">1.0</td><td class="num-cell low">1.0</td><td class="num-cell low">1.4</td></tr>
                            <tr><td class="mod-cell">Voice</td><td class="num-cell low">2.0</td><td class="num-cell low">2.0</td><td class="num-cell">6.0</td><td class="num-cell low">1.0</td><td class="num-cell low">2.0</td><td class="num-cell low">2.6</td></tr>
                            <tr class="avg-row"><td class="cat-cell">Average</td><td></td><td class="num-cell low">2.9</td><td class="num-cell low">2.7</td><td class="num-cell">5.5</td><td class="num-cell low">1.6</td><td class="num-cell low">2.0</td><td class="num-cell low">2.9</td></tr>
                        </tbody>
                    </table>
                </div>
                <p class="table-caption">Math reasoning is most robust overall (2.9% avg). Negation remains the key challenge (12.8%). GPT-5 shows best performance (1.6%).</p>
            </div>

            <!-- IFEval -->
            <div class="tab-panel" id="ifeval" role="tabpanel">
                <h3>Instruction Following <span class="task-badge gen">Generation</span></h3>
                <div class="table-wrapper">
                    <table>
                        <thead>
                            <tr><th>Category</th><th>Modification</th><th>GPT-4o</th><th>Claude-3.5</th><th>Llama 3.1</th><th>GPT-5</th><th>DS R1</th><th>Avg</th></tr>
                        </thead>
                        <tbody>
                            <tr><td class="cat-cell" rowspan="3">Bias</td><td class="mod-cell">Temporal</td><td class="num-cell med">11.1</td><td class="num-cell">4.0</td><td class="num-cell med">12.1</td><td class="num-cell">5.1</td><td class="num-cell med">12.1</td><td class="num-cell">8.9</td></tr>
                            <tr><td class="mod-cell">Geographical</td><td class="num-cell">9.0</td><td class="num-cell med">12.0</td><td class="num-cell med">14.0</td><td class="num-cell">9.0</td><td class="num-cell med">10.0</td><td class="num-cell med">10.8</td></tr>
                            <tr><td class="mod-cell">Length</td><td class="num-cell med">11.0</td><td class="num-cell med">10.0</td><td class="num-cell high">18.0</td><td class="num-cell">6.0</td><td class="num-cell high">16.0</td><td class="num-cell med">12.2</td></tr>
                            <tr><td class="cat-cell" rowspan="3">Orthography</td><td class="mod-cell">Capitalization</td><td class="num-cell">8.1</td><td class="num-cell">5.1</td><td class="num-cell med">10.1</td><td class="num-cell">9.1</td><td class="num-cell med">13.1</td><td class="num-cell">9.1</td></tr>
                            <tr><td class="mod-cell">Punctuation</td><td class="num-cell">7.1</td><td class="num-cell">3.0</td><td class="num-cell med">13.1</td><td class="num-cell">8.1</td><td class="num-cell med">12.1</td><td class="num-cell">8.7</td></tr>
                            <tr><td class="mod-cell">Spelling</td><td class="num-cell">3.1</td><td class="num-cell">4.1</td><td class="num-cell">7.2</td><td class="num-cell">6.2</td><td class="num-cell">8.2</td><td class="num-cell">5.8</td></tr>
                            <tr><td class="cat-cell" rowspan="2">Syntax</td><td class="mod-cell">Conjunction</td><td class="num-cell med">11.0</td><td class="num-cell">7.0</td><td class="num-cell">6.0</td><td class="num-cell">8.0</td><td class="num-cell med">11.0</td><td class="num-cell">8.6</td></tr>
                            <tr><td class="mod-cell">Voice</td><td class="num-cell">9.0</td><td class="num-cell">9.0</td><td class="num-cell med">10.0</td><td class="num-cell">6.0</td><td class="num-cell high">15.0</td><td class="num-cell">9.8</td></tr>
                            <tr><td class="cat-cell" rowspan="2">Semantics</td><td class="mod-cell">Concept</td><td class="num-cell">9.1</td><td class="num-cell">7.1</td><td class="num-cell med">11.1</td><td class="num-cell">7.1</td><td class="num-cell">7.1</td><td class="num-cell">8.3</td></tr>
                            <tr><td class="mod-cell">Negation</td><td class="num-cell high">24.0</td><td class="num-cell high">22.0</td><td class="num-cell high">24.0</td><td class="num-cell high">23.0</td><td class="num-cell high">23.0</td><td class="num-cell high">23.2</td></tr>
                            <tr><td class="cat-cell">Discourse</td><td class="mod-cell">Appraisal</td><td class="num-cell">7.1</td><td class="num-cell">4.1</td><td class="num-cell med">11.2</td><td class="num-cell">7.1</td><td class="num-cell">6.1</td><td class="num-cell">7.1</td></tr>
                            <tr><td class="cat-cell" rowspan="2">Varieties</td><td class="mod-cell">Style</td><td class="num-cell high">18.0</td><td class="num-cell">7.0</td><td class="num-cell med">10.0</td><td class="num-cell">9.0</td><td class="num-cell med">11.0</td><td class="num-cell med">11.0</td></tr>
                            <tr><td class="mod-cell">Dialect</td><td class="num-cell med">13.0</td><td class="num-cell med">13.0</td><td class="num-cell med">12.0</td><td class="num-cell med">11.0</td><td class="num-cell high">15.0</td><td class="num-cell med">12.8</td></tr>
                            <tr class="avg-row"><td class="cat-cell">Average</td><td></td><td class="num-cell med">10.8</td><td class="num-cell">8.3</td><td class="num-cell med">12.2</td><td class="num-cell">8.8</td><td class="num-cell med">12.3</td><td class="num-cell med">10.5</td></tr>
                        </tbody>
                    </table>
                </div>
                <p class="table-caption">IFEval shows highest overall unrobustness (10.5% avg). Negation (23.2%) and Dialect (12.8%) cause most failures.</p>
            </div>

            <!-- Scaling -->
            <div class="tab-panel" id="scaling" role="tabpanel">
                <h3>Llama Model Scaling <span class="task-badge gen">GSM Task</span></h3>
                <p style="margin-bottom: 20px; color: var(--gray-700);">How does model size affect robustness? We compare Llama 3.1 at 8B, 70B, and 405B parameters on the GSM math task.</p>
                <div class="table-wrapper">
                    <table>
                        <thead>
                            <tr><th>Category</th><th>Modification</th><th>Llama 8B</th><th>Llama 70B</th><th>Llama 405B</th><th>Avg</th></tr>
                        </thead>
                        <tbody>
                            <tr><td class="cat-cell" rowspan="3">Bias</td><td class="mod-cell">Temporal</td><td class="num-cell">8.0</td><td class="num-cell">5.0</td><td class="num-cell">4.0</td><td class="num-cell">5.7</td></tr>
                            <tr><td class="mod-cell">Geographical</td><td class="num-cell">8.0</td><td class="num-cell">3.0</td><td class="num-cell">7.0</td><td class="num-cell">6.0</td></tr>
                            <tr><td class="mod-cell">Length</td><td class="num-cell">8.0</td><td class="num-cell low">2.0</td><td class="num-cell low">2.0</td><td class="num-cell">4.0</td></tr>
                            <tr><td class="cat-cell" rowspan="3">Orthography</td><td class="mod-cell">Spelling</td><td class="num-cell med">10.0</td><td class="num-cell low">2.0</td><td class="num-cell low">2.0</td><td class="num-cell">4.7</td></tr>
                            <tr><td class="mod-cell">Capitalization</td><td class="num-cell med">11.0</td><td class="num-cell low">2.0</td><td class="num-cell">5.0</td><td class="num-cell">6.0</td></tr>
                            <tr><td class="mod-cell">Punctuation</td><td class="num-cell">5.0</td><td class="num-cell low">1.0</td><td class="num-cell">5.0</td><td class="num-cell">3.7</td></tr>
                            <tr><td class="cat-cell" rowspan="2">Semantics</td><td class="mod-cell">Concept</td><td class="num-cell med">12.0</td><td class="num-cell low">1.0</td><td class="num-cell">5.0</td><td class="num-cell">6.0</td></tr>
                            <tr><td class="mod-cell">Negation</td><td class="num-cell high">22.0</td><td class="num-cell high">17.0</td><td class="num-cell high">18.0</td><td class="num-cell high">19.0</td></tr>
                            <tr><td class="cat-cell">Discourse</td><td class="mod-cell">Appraisal</td><td class="num-cell">7.0</td><td class="num-cell">5.0</td><td class="num-cell low">1.0</td><td class="num-cell">4.3</td></tr>
                            <tr><td class="cat-cell" rowspan="2">Varieties</td><td class="mod-cell">Style</td><td class="num-cell high">16.0</td><td class="num-cell">6.0</td><td class="num-cell">6.0</td><td class="num-cell">9.3</td></tr>
                            <tr><td class="mod-cell">Dialect</td><td class="num-cell med">10.0</td><td class="num-cell">6.0</td><td class="num-cell">6.0</td><td class="num-cell">7.3</td></tr>
                            <tr><td class="cat-cell" rowspan="2">Syntax</td><td class="mod-cell">Conjunction</td><td class="num-cell med">12.0</td><td class="num-cell low">2.0</td><td class="num-cell">4.0</td><td class="num-cell">6.0</td></tr>
                            <tr><td class="mod-cell">Voice</td><td class="num-cell med">11.0</td><td class="num-cell low">2.0</td><td class="num-cell">6.0</td><td class="num-cell">6.3</td></tr>
                            <tr class="avg-row"><td class="cat-cell">Average</td><td></td><td class="num-cell med">10.8</td><td class="num-cell">4.2</td><td class="num-cell">5.5</td><td class="num-cell">6.8</td></tr>
                        </tbody>
                    </table>
                </div>

                <p class="table-caption">
                    <strong>Key finding:</strong> Scaling from 8B→70B dramatically improves robustness (10.8%→4.2%), but 70B→405B shows diminishing returns (4.2%→5.5%).
                    Negation remains challenging across all scales (17-22%). Larger models achieve higher accuracy but don't always translate to better robustness.
                </p>
            </div>

            <p class="table-caption" style="margin-top: 24px;">
                Color legend: <span class="high" style="padding: 2px 6px;">High</span> ≥15% &nbsp; <span class="med" style="padding: 2px 6px;">Medium</span> 10-15% &nbsp; <span class="low" style="padding: 2px 6px;">Low</span> ≤2%
            </p>
        </div>
    </section>

    <section id="citation">
        <div class="container">
            <div class="section-title">Citation</div>
            <h2>Cite This Work</h2>
            <div class="citation-box">
                <button class="copy-btn" onclick="copyBibtex()">Copy</button>
                <pre>@article{otmakhova2025fluke,
  title     = {FLUKE: A Linguistically-Driven and Task-Agnostic
               Framework for Robustness Evaluation},
  author    = {Otmakhova, Yulia and Truong, Hung Thinh and
               Mahendra, Rahmad and Zhai, Zenan and Zhu, Rongxin
               and Beck, Daniel and Lau, Jey Han},
  journal   = {arXiv preprint arXiv:2504.17311},
  year      = {2025}
}</pre>
            </div>
        </div>
    </section>

    <footer>
        <div class="container">
            FLUKE · <a href="https://arxiv.org/abs/2504.17311">Paper</a> · <a href="https://github.com/joey234/fluke">Code</a> · <a href="https://huggingface.co/datasets/unimelb-nlp/fluke">Dataset</a> · <a href="https://fluke-viewer.pages.dev/">Demo</a>
        </div>
    </footer>

    <script>
        function copyBibtex() {
            const text = document.querySelector('.citation-box pre').textContent;
            navigator.clipboard.writeText(text).then(() => {
                const btn = document.querySelector('.copy-btn');
                btn.textContent = 'Copied!';
                setTimeout(() => btn.textContent = 'Copy', 2000);
            });
        }

        // Tab switching
        document.querySelectorAll('.tab').forEach(tab => {
            tab.addEventListener('click', () => {
                const targetId = tab.dataset.tab;

                // Update tabs
                document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                tab.classList.add('active');

                // Update panels
                document.querySelectorAll('.tab-panel').forEach(p => p.classList.remove('active'));
                document.getElementById(targetId).classList.add('active');
            });
        });
    </script>

    <!-- Flukify Demo Script -->
    <script>
        const MODIFICATION_PROMPTS = {
            capitalization: `Modify the capitalization of the text in one of these ways:
- lowercase: convert to all lowercase
- UPPERCASE: convert to all uppercase
- Title Case: capitalize first letter of each word
- rAnDoM: randomize capitalization (spongebob style)
- selective: capitalize random non-proper-noun words

Text: {text}

Return JSON with the modified text.`,

            punctuation: `Modify the punctuation of the text in one of these ways:
- removal: remove some punctuation marks
- addition: add extra punctuation (commas, periods)
- substitution: replace punctuation with similar marks
- glueing: remove spaces around punctuation

Text: {text}

Return JSON with the modified text.`,

            typo: `Introduce a realistic typo in the text using one of these methods:
- addition: add an extra character (e.g., "compellling")
- omission: remove a character (e.g., "writen")
- substitution: swap a character for nearby key (e.g., "teh" for "the")
- transposition: swap adjacent characters (e.g., "hte" for "the")

Make only 1-2 small typos that a human might naturally make.

Text: {text}

Return JSON with the modified text.`,

            derivation: `Replace a word with a morphologically related form:
- Change verb forms (created → born, developed → made)
- Change noun forms (town → municipality, company → firm)
- Use derived forms (happy → happiness → happily)

The meaning should remain similar.

Text: {text}

Return JSON with the modified text.`,

            compound: `Modify compound words or add compound modifiers:
- Split compounds: "website" → "web site"
- Join words: "ice cream" → "ice-cream"
- Add compound modifiers: "community" → "gated community"

Text: {text}

Return JSON with the modified text.`,

            active_to_passive: `Convert active voice to passive voice or vice versa:
- Active: "The cat caught the mouse" → Passive: "The mouse was caught by the cat"
- Maintain the same meaning and entities

Text: {text}

Return JSON with the modified text.`,

            grammatical_role: `Swap grammatical roles while trying to maintain grammaticality:
- Swap subject and object positions
- Change the syntactic structure while preserving words

Text: {text}

Return JSON with the modified text.`,

            coordinating_conjunction: `Add or modify coordinating conjunctions:
- Add "and", "but", "or" to connect clauses
- Expand with additional coordinated elements
- Example: "making headlines" → "escalating and making headlines"

Text: {text}

Return JSON with the modified text.`,

            concept_replacement: `Replace a concept with a semantically related word:
- Synonym: "big" → "large"
- Hypernym: "dog" → "animal"
- Hyponym: "vehicle" → "car"
- Related concept: "angst" → "distress"

The overall meaning should remain similar.

Text: {text}

Return JSON with the modified text.`,

            negation: `Introduce negation into the text using one of these types:
- verbal: "He trusts them" → "He does not trust them"
- absolute: "He trusts everyone" → "He trusts no one"
- approximate: "He always helps" → "He rarely helps"
- affixal: "healthy" → "unhealthy"
- lexical: "big" → "small"

Text: {text}

Return JSON with the modified text.`,

            discourse_markers: `Modify discourse markers/connectives:
- Add: "Santa is innocent" → "Moreover, Santa is innocent"
- Remove: "However, he left" → "He left"
- Replace: "Therefore" → "Thus"

Text: {text}

Return JSON with the modified text.`,

            sentiment: `Add sentiment/appraisal markers without changing core meaning:
- Add adverbs: "recruited" → "reluctantly recruited"
- Add adjectives: "established" → "barely established"
- Add emotional tone while preserving factual content

Text: {text}

Return JSON with the modified text.`,

            dialectal: `Transform to a dialect variation:
- Singlish: "That's delicious!" → "Shiok lah!"
- AAVE: Standard → African American Vernacular English features
- British/American: "apartment" ↔ "flat"

Maintain meaning while changing dialect markers.

Text: {text}

Return JSON with the modified text.`,

            casual: `Transform between formal and casual register:
- Formal → Casual: "1945 film" → "'45 flick"
- Use contractions, slang, informal vocabulary
- Or reverse: make casual text more formal

Text: {text}

Return JSON with the modified text.`,

            temporal_bias: `Apply temporal/archaic variations:
- Modern → Old-fashioned: "villainess" → "villainness"
- Update dated terms or use archaic alternatives
- Change time references

Text: {text}

Return JSON with the modified text.`,

            geographical_bias: `Change geographical/cultural references:
- Swap nationalities: "American" → "Nauruan"
- Change location names to equivalent but different places
- Modify cultural references

Text: {text}

Return JSON with the modified text.`,

            length_bias: `Modify the length of the text:
- Shorten: Remove redundant words, use contractions
- Lengthen: Add clarifying phrases, be more verbose
- Target ~20% length change while preserving meaning

Text: {text}

Return JSON with the modified text.`
        };

        const SYSTEM_PROMPT = `You are a linguist specializing in text modification. Your task is to make minimal, controlled modifications to text based on specific linguistic aspects. These modifications should preserve the core meaning while introducing linguistic variations that can test model robustness.

Always return valid JSON with the structure:
{
    "modified": "the modified text",
    "type": "specific modification subtype applied",
    "rationale": "brief explanation of what was changed"
}`;

        async function runFlukify() {
            const inputText = document.getElementById('demo-input').value.trim();
            const modification = document.getElementById('demo-mod').value;
            const apiKey = document.getElementById('demo-api-key').value.trim();
            const statusEl = document.getElementById('demo-status');
            const outputEl = document.getElementById('demo-output');
            const metaEl = document.getElementById('demo-meta');
            const btn = document.getElementById('demo-btn');

            // Validation
            if (!inputText) {
                statusEl.textContent = 'Please enter some text to modify.';
                statusEl.className = 'demo-status error';
                return;
            }

            if (!apiKey) {
                statusEl.textContent = 'Please enter your OpenAI API key.';
                statusEl.className = 'demo-status error';
                return;
            }

            // Update UI
            btn.disabled = true;
            btn.textContent = 'Processing...';
            statusEl.textContent = 'Calling OpenAI API...';
            statusEl.className = 'demo-status';
            outputEl.value = '';
            metaEl.classList.remove('visible');

            try {
                const prompt = MODIFICATION_PROMPTS[modification].replace('{text}', inputText);

                const response = await fetch('https://api.openai.com/v1/chat/completions', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${apiKey}`
                    },
                    body: JSON.stringify({
                        model: 'gpt-4o-mini',
                        messages: [
                            { role: 'system', content: SYSTEM_PROMPT },
                            { role: 'user', content: prompt }
                        ],
                        temperature: 0.3,
                        response_format: { type: 'json_object' }
                    })
                });

                if (!response.ok) {
                    const error = await response.json();
                    throw new Error(error.error?.message || 'API request failed');
                }

                const data = await response.json();
                const content = data.choices[0].message.content;
                const result = JSON.parse(content);

                // Display results
                outputEl.value = result.modified || inputText;
                document.getElementById('meta-type').textContent = result.type || 'N/A';
                document.getElementById('meta-rationale').textContent = result.rationale || 'N/A';
                metaEl.classList.add('visible');

                statusEl.textContent = 'Modification applied successfully!';
                statusEl.className = 'demo-status success';

            } catch (error) {
                statusEl.textContent = 'Error: ' + error.message;
                statusEl.className = 'demo-status error';
            } finally {
                btn.disabled = false;
                btn.textContent = 'Apply Modification';
            }
        }

        // Allow Enter key in API key field to trigger modification
        document.getElementById('demo-api-key').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                runFlukify();
            }
        });

        // Demo tab switching
        document.querySelectorAll('.demo-tab').forEach(tab => {
            tab.addEventListener('click', () => {
                document.querySelectorAll('.demo-tab').forEach(t => t.classList.remove('active'));
                document.querySelectorAll('.demo-panel').forEach(p => p.classList.remove('active'));
                tab.classList.add('active');
                document.getElementById(tab.dataset.panel).classList.add('active');
            });
        });

        // File upload handling
        let uploadedData = null;
        let uploadedFileName = '';

        function handleFileSelect(input) {
            const file = input.files[0];
            if (!file) return;

            uploadedFileName = file.name;
            const reader = new FileReader();

            reader.onload = function(e) {
                const content = e.target.result;
                try {
                    if (file.name.endsWith('.csv')) {
                        uploadedData = parseCSV(content);
                    } else if (file.name.endsWith('.jsonl')) {
                        uploadedData = parseJSONL(content);
                    } else if (file.name.endsWith('.json')) {
                        uploadedData = JSON.parse(content);
                    }

                    document.getElementById('file-upload').classList.add('has-file');
                    document.getElementById('file-upload-text').innerHTML =
                        `<strong>${file.name}</strong><br>${uploadedData.length} rows loaded`;

                    // Try to auto-detect text field
                    if (uploadedData.length > 0) {
                        const cols = Object.keys(uploadedData[0]);
                        const textCols = ['text', 'sentence', 'content', 'input', 'question'];
                        for (const tc of textCols) {
                            if (cols.includes(tc)) {
                                document.getElementById('batch-text-field').value = tc;
                                break;
                            }
                        }
                    }
                } catch (err) {
                    alert('Error parsing file: ' + err.message);
                    uploadedData = null;
                }
            };

            reader.readAsText(file);
        }

        function parseCSV(content) {
            const lines = content.trim().split('\n');
            if (lines.length < 2) return [];

            // Parse header
            const headers = parseCSVLine(lines[0]);
            const data = [];

            for (let i = 1; i < lines.length; i++) {
                if (!lines[i].trim()) continue;
                const values = parseCSVLine(lines[i]);
                const row = {};
                headers.forEach((h, idx) => {
                    row[h] = values[idx] || '';
                });
                data.push(row);
            }

            return data;
        }

        function parseCSVLine(line) {
            const result = [];
            let current = '';
            let inQuotes = false;

            for (let i = 0; i < line.length; i++) {
                const char = line[i];
                if (char === '"') {
                    if (inQuotes && line[i + 1] === '"') {
                        current += '"';
                        i++;
                    } else {
                        inQuotes = !inQuotes;
                    }
                } else if (char === ',' && !inQuotes) {
                    result.push(current);
                    current = '';
                } else {
                    current += char;
                }
            }
            result.push(current);
            return result;
        }

        function parseJSONL(content) {
            return content.trim().split('\n')
                .filter(line => line.trim())
                .map(line => JSON.parse(line));
        }

        function selectAllMods() {
            document.querySelectorAll('input[name="batch-mod"]').forEach(cb => cb.checked = true);
        }

        function selectNoneMods() {
            document.querySelectorAll('input[name="batch-mod"]').forEach(cb => cb.checked = false);
        }

        // Batch processing
        let batchAborted = false;

        async function runBatchFlukify() {
            if (!uploadedData || uploadedData.length === 0) {
                showBatchStatus('Please upload a file first.', 'error');
                return;
            }

            const textField = document.getElementById('batch-text-field').value.trim();
            const sampleSize = parseInt(document.getElementById('batch-sample').value) || uploadedData.length;
            const apiKey = document.getElementById('batch-api-key').value.trim();
            const model = document.getElementById('batch-model').value;

            if (!apiKey) {
                showBatchStatus('Please enter your OpenAI API key.', 'error');
                return;
            }

            // Check text field exists
            if (uploadedData.length > 0 && !(textField in uploadedData[0])) {
                const cols = Object.keys(uploadedData[0]).join(', ');
                showBatchStatus(`Column "${textField}" not found. Available: ${cols}`, 'error');
                return;
            }

            // Get selected modifications
            const selectedMods = Array.from(document.querySelectorAll('input[name="batch-mod"]:checked'))
                .map(cb => cb.value);

            if (selectedMods.length === 0) {
                showBatchStatus('Please select at least one modification.', 'error');
                return;
            }

            // Sample data
            let data = uploadedData.slice(0, sampleSize);

            // Calculate total operations
            const totalOps = data.length * selectedMods.length;
            let completedOps = 0;

            // Show progress
            const progressContainer = document.getElementById('progress-container');
            const progressFill = document.getElementById('progress-fill');
            const progressText = document.getElementById('progress-text');
            const btn = document.getElementById('batch-btn');

            progressContainer.classList.add('visible');
            btn.disabled = true;
            btn.textContent = 'Processing...';
            batchAborted = false;

            const results = [];

            try {
                for (const mod of selectedMods) {
                    if (batchAborted) break;

                    for (let i = 0; i < data.length; i++) {
                        if (batchAborted) break;

                        const row = data[i];
                        const text = String(row[textField] || '');

                        // Update progress
                        completedOps++;
                        const pct = Math.round((completedOps / totalOps) * 100);
                        progressFill.style.width = pct + '%';
                        progressText.textContent = `Processing ${mod} (${completedOps}/${totalOps})...`;

                        // Make API call
                        try {
                            const result = await callOpenAI(text, mod, apiKey, model);
                            results.push({
                                ...row,
                                modification_type: mod,
                                modified_text: result.modified || text,
                                modification_subtype: result.type || '',
                                modification_rationale: result.rationale || ''
                            });
                        } catch (err) {
                            results.push({
                                ...row,
                                modification_type: mod,
                                modified_text: text,
                                modification_subtype: 'error',
                                modification_rationale: err.message
                            });
                        }

                        // Small delay to avoid rate limiting
                        await new Promise(r => setTimeout(r, 100));
                    }
                }

                // Generate and download CSV
                if (results.length > 0) {
                    downloadCSV(results, uploadedFileName.replace(/\.[^.]+$/, '') + '_flukified.csv');
                    showBatchStatus(`Complete! Downloaded ${results.length} modified samples.`, 'success');
                }

            } catch (err) {
                showBatchStatus('Error: ' + err.message, 'error');
            } finally {
                btn.disabled = false;
                btn.textContent = 'Process Dataset';
                progressFill.style.width = '100%';
            }
        }

        async function callOpenAI(text, modification, apiKey, model) {
            const prompt = MODIFICATION_PROMPTS[modification].replace('{text}', text);

            const response = await fetch('https://api.openai.com/v1/chat/completions', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'Authorization': `Bearer ${apiKey}`
                },
                body: JSON.stringify({
                    model: model,
                    messages: [
                        { role: 'system', content: SYSTEM_PROMPT },
                        { role: 'user', content: prompt }
                    ],
                    temperature: 0.3,
                    response_format: { type: 'json_object' }
                })
            });

            if (!response.ok) {
                const error = await response.json();
                throw new Error(error.error?.message || 'API request failed');
            }

            const data = await response.json();
            return JSON.parse(data.choices[0].message.content);
        }

        function downloadCSV(data, filename) {
            if (data.length === 0) return;

            const headers = Object.keys(data[0]);
            const csvContent = [
                headers.map(h => `"${h}"`).join(','),
                ...data.map(row =>
                    headers.map(h => {
                        const val = String(row[h] || '').replace(/"/g, '""');
                        return `"${val}"`;
                    }).join(',')
                )
            ].join('\n');

            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            a.click();
            URL.revokeObjectURL(url);
        }

        function showBatchStatus(message, type) {
            const el = document.getElementById('batch-status');
            el.textContent = message;
            el.className = 'demo-status ' + (type || '');
        }

        // Drag and drop support
        const fileUpload = document.getElementById('file-upload');
        fileUpload.addEventListener('dragover', (e) => {
            e.preventDefault();
            fileUpload.style.borderColor = 'var(--gray-900)';
        });
        fileUpload.addEventListener('dragleave', () => {
            fileUpload.style.borderColor = '';
        });
        fileUpload.addEventListener('drop', (e) => {
            e.preventDefault();
            fileUpload.style.borderColor = '';
            const file = e.dataTransfer.files[0];
            if (file) {
                document.getElementById('file-input').files = e.dataTransfer.files;
                handleFileSelect(document.getElementById('file-input'));
            }
        });
    </script>
</body>
</html>
